<div class="page-container">
    <style type="text/css">
        .tips{
            display: inline-block;
            width:10px;
            height: 10px;
            border:5px solid #e0dfdf;
            background: #949393;
            border-radius: 50%;
        }
        .success{
            border-color:#bbf3bb;
            background: #18ad18;
        }
        .error{
            border-color:#f7dae4;
            background: #ee5858;
        }
        .warn{
            border-color:#f3e0c4;
            background: #f9990d;
        }
        .initialing{
            color: #9dad51;
        }
        .running{
            color:#18ad18;
        }
        .pausing{
            color:#949393;
        }
        .shutdowning{
            color:#ee5858;
        }
        .failuring{
            color:#f9990d;
        }
    </style>
    <div class="Huialert Huialert-success"><i class="icon-remove"></i>
        <span>容器总量(单位/个)</span>:<span id="task_total">0</span> &#124;
        <span class="running">运行中</span>：<span class="running" id="task_running_total">0</span> &#124;
        <span class="pausing">暂停中</span>: <span class="pausing" id="task_pausing_total">0</span> &#124;
        <span class="initialing">初始化中</span>: <span class="initialing" id="task_initialing_total">0</span> &#124;
        <span class="shutdowning">关闭中</span>: <span class="shutdowning" id="task_shutdowning_total">0</span> &#124;
        <span class="failuring">故障中</span>: <span class="failuring" id="task_failuring_total">0</span>
    </div>
    <div class="panel panel-default">
        <div class="panel-header"><input class="btn btn-success radius" type="button" value="添加"></div>
        <div class="panel-body">
            <div class="bk-gray radius">
                <div id="quartz_list"></div>
            </div>
            <div class="bk-gray radius">
                <div id="pager_index"></div>
            </div>

        </div>
    </div>
    <script>
        require(['ajax'],function(AjaxUtils){
            AjaxUtils.ajaxSimple(
                'post',
                AjaxUtils.URLS.quartzURLS.monitorContainerScheduler,
                'json',
                AjaxUtils.ajaxParam,
                AjaxUtils.Constant.Ajax.TIME_OUT,
                function(data){
                    /**
                     * 分页返回结果格式，其中content内为分页对象Pager
                     * {
                                     *   code : 0,
                                     *   desc : 'response ok',
                                     *   content : {
                                     *       pages : 5,       --总页数
                                     *       rows : [{},{}],  --数据列表
                                     *       total : 100,     --总数
                                     *       pageSize : 10    --页面大小
                                     *   }
                                     * }
                     */
                    if(data&&data.code==0){
                        if(!AjaxUtils.StringUtils.isEmpty_(data.content)){
                            $("#task_total").innerText(data.content.total||0);
                            $("#task_running_total").innerText(data.content.runnings||0);
                            $("#task_pausing_total").innerText(data.content.pausings||0);
                            $("#task_initialing_total").innerText(data.content.initialings||0);
                            $("#task_shutdowning_total").innerText(data.content.shutdownings||0);
                            $("#task_failuring_total").innerText(data.content.failurings||0);
                        }
                    }
                }
            )
        })

        require(['layPageUtils'],function(LayPageUtils){
            LayPageUtils.AjaxUtils.ajaxParam.root.msg = {
                quartzInfo: {
                    "schedulerId": "d43ff64a173d4c4f9c125a501c4f5b73",
                    "jobName": "test1",
                    "jobClass": "hq.com.quartz.QuartzDemo",
                    "jobGroupName": "",
                    "triggerGroupName": "",
                    "time": "0/1 * * * * ?",
                    "switchType": "33",
                    "page": "1",
                    "pageSize": "10"
                }
            }
            var data =[
                {
                    schedulerId :"123456",
                    jobName:"中国银行",
                    jobClass:"hq.com.Dao.TEST",
                    jobGroupName:"中国",
                    triggerGroupName:"呵呵",
                    time:"* 0/1 * * * ?",
                    statusEnum:"running",
                    started:true,
                    shutdown:false,
                    inStandbyMode:false
                },
                {
                    schedulerId :"123457",
                    jobName:"中国银行2",
                    jobClass:"hq.com.Dao.TEST2",
                    jobGroupName:"中国",
                    triggerGroupName:"呵呵",
                    time:"* 0/1 * * * ?",
                    statusEnum:"running",
                    started:true,
                    shutdown:true,
                    inStandbyMode:true
                },
                {
                    schedulerId :"123458",
                    jobName:"中国银行3",
                    jobClass:"hq.com.Dao.TEST3",
                    jobGroupName:"中国",
                    triggerGroupName:"呵呵",
                    time:"* 0/1 * * * ?",
                    statusEnum:"running",
                    started:false,
                    shutdown:true,
                    inStandbyMode:true
                }
            ]
            LayPageUtils.dataGride({
//                data_:data,
                url : LayPageUtils.AjaxUtils.URLS.quartzURLS.getSchedulerList,
                params :LayPageUtils.AjaxUtils.ajaxParam,
                type:'json',
                method : 'post',
                tableId:'quartz_list',
                cont: document.getElementById('pager_index'),
                skip: true,
                skin: '#00AA91',
                groups: 5 ,
                first:"首页",
                last:"尾页",
                prev:"<",
                next:">",
                data:[
                    {
                        name:'任务ID',
                        value:'schedulerId',
                        align:'text-c',
                        width:'10%',
                        order:true,
                        iShow:true
                    },{
                        name:'任务名称',
                        value:'jobName',
                        align:'text-c',
                        width:'10%',
                        order:true,
                        iShow:true,
                        formartVal:function(value,row){
                            return value;
                        }
                    },{
                        name:'任务包名+类名',
                        value:'jobClass',
                        align:'text-c',
                        width:'15%',
                        iShow:true,
                        formartVal:function(value,row){
                            return value;
                        }
                    },{
                        name:'任务组名',
                        value:'jobGroupName',
                        align:'text-c',
                        width:'10%',
                        iShow:true,
                        formartVal:function(value,row){
                            return value;
                        }
                    },{
                        name:'触发器组名',
                        value:'triggerGroupName',
                        align:'text-c',
                        width:'10%',
                        iShow:true,
                        formartVal:function(value,row){
                            return value;
                        }
                    },{
                        name:'触发时间',
                        value:'time',
                        align:'text-c',
                        width:'10%',
                        iShow:true,
                        formartVal:function(value,row){
                            return value;
                        }
                    },{
                        name:'<span title="1. initialing:初始化中\n2. running:运行中 \n3. pausing:暂停中 \n4. shutdowning:关闭中">任务状态</span>',
                        value:'statusEnum',
                        align:'text-c',
                        width:'10%',
                        iShow:true,
                        formartVal:function(value,row){
                            return value;
                        }
                    },{
                        name:'started|shutdown|inStandbyMode',
                        value:'status',
                        align:'text-c',
                        width:'20%',
                        iShow:true,
                        formartVal:function(row){
                            if(row.statusEnum=='initialing'){
                                return '<span class="tips"/>&#124;<span class="tips"/>&#124;<span class="tips"/>';
                            }else{
                                var tips = row.started==true?'<span class="tips success"/>&#124;':'<span class="tips error"/>&#124;';
                                tips+=row.shutdown==true?'<span class="tips success"/>&#124;':'<span class="tips error"/>&#124;';
                                tips+=row.inStandbyMode==true?'<span class="tips success"/>':'<span class="tips error"/>';
                            }
                            return tips;
                        }
                    },{
                        name:'操作',
                        value:'option',
                        align:'text-l',
                        iShow:true,
                        formartVal:function(data){
                            return '<input class="btn btn-success radius" type="button" onclick="alert('+data.jobName+')" value="成功">';
                        }
                    }
                ]
            });
        })
    </script>
</div>